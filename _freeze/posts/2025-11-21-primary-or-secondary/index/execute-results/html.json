{
  "hash": "1462f3ea9862a6aee8ad8a5e0fd918a0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Primary or Secondary? A Question of Ulimate Cause\"\ndate: 2025-11-21\ncategories: [causal inference, spatial autocorrelation]\nformat:\n  html:\n    toc: true\n---\n\nLet's suppose we are interested in the relationship between disturbance (D) and vegetation diversity (V). We assert that disturbance has a causal effect on diversity such that $D \\rightarrow V$. This causal relationship can be represented using a simple directed acyclic graph (DAG). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dagitty)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dagitty' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggdag' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'ggdag'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\ndag1 = dagify(\n  V ~ D, \n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag1, layout = 'grid') + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\nBoth disturbance and vegetation diversity arise from spatial processes, and the data we use to study them are collected in space. This makes it natural to assume that there may be some spatial autocorrelation in these measures. We might think it is simply a question of how to control for this autocorrelation so that we can get a precise estimate of the effect of D on V. For example, we might use a conditional autoregressive model, treating D and V as emissions from a random field. \n\nHowever, I argue that rather than assuming we must control for autocorrelation, we need o first determine whether we need to adjust for autocorrelation by looking at the problem  from a causal inference perspective. \n\nFor example, let's suppose that D and V arise jointly from a spatial process S. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag2 = dagify(\n  V ~ D, \n  D ~ S, \n  V ~ S,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag2, layout = 'circle') + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\nThis DAG says that both of our measures, D and V, are caused by the same spatial process. Put differently, the effect of D on V is confounded by spatial autocorrelation in these variables. This implies that we must include S in a model. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdag_adjustment_set(dag2) + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nSimple enough. But is this actually plausible? If true, then disturbance and vegetation diversity must both occur at a similar scale. This is a strong assumption considering that measures of vegetation diversity occur at the organism or stand level, whereas disturbance is typically a patch level phenomenon. If there is spatial structure to these measures, they would occur at distinct scales. \n\nMoreover, the processes that underlie this spatial structure are probably distinct. Disturbances, for example, can be due to tree-falls, hurricanes, landslides, anthropogenic land changes, diseases or pest outbreaks, and so on. These are quite different from the processes that shape vegetation diversity like local competition, facilitation, and mutualism; dispersal and recruitment; or nutrient availability. \n\nIt seems more likely that D and V have their own spatial patterns arises from distinct processes. This implies a DAG like this: \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag3 = dagify(\n  V ~ D, \n  D ~ S_D, \n  V ~ S_V,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag3, layout = 'tree') + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nIf this is our generating process, then we need to be much more careful about including S_D and S_V in a model. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdag_adjustment_set(dag3) + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\nThe current structure contains no backdoor paths. If we include S_D, for example, then we will filter our any effect of D that is correlated with S_D. One could then ask: \"Why not condition directly on S_D and leave our D, altogether?\" This *could* work but only if we know that the variation in S_D is due solely to the disturbance. S_V does not have these same issues We could include S_V as a covariate that might improve the precision of our estimate of D on V. \n\n## Primary and Secondary Structure \n\nNow here is where this gets interesting. S_D and S_V are what some might call \"secondary spatial structure\". They are patterns of vegetation and disturbance that are overlaid on the landscape with all its topography and geomorphology -- the primary spatial structure. One could very reasonably assume that this primary structure influences the secondary structure. Indeed, many have debated this tension in the literature. A DAG representing this might look like the following:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag4 = dagify(\n  V ~ D, \n  D ~ S_D, \n  V ~ S_V,\n  S_D ~ P, \n  S_V ~ P,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag4, layout = 'tree') + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\nNow we again have a backdoor between D and V through the influence of P on S_D and S_V. This means that in order to estimate the relationship between D and V, we must adust for P, assuming that we have a measure of it. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdag_adjustment_set(dag4) + theme_void()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nFurther, one can break the backdoor path by adjusting for any of the parents of D and V. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}