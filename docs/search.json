[
  {
    "objectID": "projects.html#project-2",
    "href": "projects.html#project-2",
    "title": "Projects",
    "section": "Project 2",
    "text": "Project 2"
  },
  {
    "objectID": "projects.html#project-3",
    "href": "projects.html#project-3",
    "title": "Projects",
    "section": "Project 3",
    "text": "Project 3"
  },
  {
    "objectID": "posts/2025-12-02-spatial-patterns-1/index.html",
    "href": "posts/2025-12-02-spatial-patterns-1/index.html",
    "title": "Spatial Patterns and Random Fields I",
    "section": "",
    "text": "Landscapes contain myriad spatial patterns. These patterns interest us because of their implications for a variety of ecological processes. Here I treat landscapes as random fields and examine the spatial patterns the arise from them. A random field treats a lattice as a continuous surface; a vegetation gradient. Patterns arise on this surface by creating random noise and then smoothing it based on correlation distances.\n\nWhite noise has structure inside it; smoothing reveals it.\n\nThe objectives of this exercise are to 1. learn to generate random fields, and 2. learn the methods of summarise them (spatial variance, correlation lengths)."
  },
  {
    "objectID": "posts/2025-12-02-spatial-patterns-1/index.html#gaussian-kernel",
    "href": "posts/2025-12-02-spatial-patterns-1/index.html#gaussian-kernel",
    "title": "Spatial Patterns and Random Fields I",
    "section": "Gaussian Kernel",
    "text": "Gaussian Kernel\nNext we define a kernel \\(K_{\\ell}(\\Delta i, \\Delta j)\\) that depends on the differences between a pair of cells in the lattice. To start, we use a Guassian kernel\n\\[\n\\begin{align}\nK_{\\ell}(\\Delta i, \\Delta j) = \\text{exp}\\biggl(\\frac{\\Delta i^2 + \\Delta j^2)}{2\\ell^2}\\biggr).\n\\end{align}\n\\] The notation \\(\\Delta i\\) and \\(\\Delta j\\) capture the differences between the values at cell locations. The locations of these comparison cells are \\((u,v)\\), with \\(\\Delta i = i - u\\) and \\(\\Delta j = j - v\\). Here \\(\\ell\\) is a scale parameter that controls the correlation length.\n\nWhen \\(\\ell\\) is small, the patterns are peaked and rugged.\nWhen \\(\\ell\\) is large, the patterns are smoother, averaged over many neighbors."
  },
  {
    "objectID": "posts/2025-12-02-spatial-patterns-1/index.html#convolution",
    "href": "posts/2025-12-02-spatial-patterns-1/index.html#convolution",
    "title": "Spatial Patterns and Random Fields I",
    "section": "Convolution",
    "text": "Convolution\nTo construct the random field \\(X(i,j)\\), we smooth over the noisy field \\(\\varepsilon(i,j)\\) using the chosen Gaussian kernel function. Mathematically, this looks like\n\\[\n\\begin{align}\nX(i,j) = \\sum^N_{u=1} \\sum^N_{v=1} K_{\\ell}(i-u,\\ j-v)\\varepsilon(u,v)\n\\end{align}\n\\]\nFor each focal cell \\((i,j)\\), we examine a reference pixel \\((u,v)\\) and compute the difference. This is used to assign a weight \\(w = K_{\\ell}(\\Delta i, \\Delta j)\\) that is multiplied by the noise \\(\\varepsilon(u,v)\\). We sum over these such that \\(X(i,j)\\) is a weighted average."
  },
  {
    "objectID": "posts/2025-11-20-food-web-measurement-2/index.html",
    "href": "posts/2025-11-20-food-web-measurement-2/index.html",
    "title": "Food Web Generation and Measurement II",
    "section": "",
    "text": "In the previous post, we discussed how the probability of a feeding link between two species depends in part on the probability of detecting the link during the sampling effort. Accounting for this is an important step toward understanding whether the food web structure we are studying is due to ecological processes that underlie community assembly, or some sampling bias (or both).\nAs a reminder, our existing model treats the probability of an observed link in a web (\\(A_{ij,k}\\)) as\n\n\n\\[\n\\begin{align}\nA_{ij,k} &\\sim \\text{Bernoulli}(q_{ij,k}) \\\\\nq_{ij,k} &= p_k \\pi_{ij,k} \\\\\np_k &= \\text{logit}^{-1}(\\mu_{p} + \\sigma_p p^{(z)}_k) \\\\\n\\pi_{ij,k} &= \\text{logit}^{-1}(\\alpha_k + u_{i,k} + v_{j,k}) \\\\\n\\alpha_k &= \\mu_{\\alpha} + \\sigma_{\\alpha} \\alpha^{(z)}_k \\\\\nu_{i,k} &= \\sigma_u u^{(z)}_{i,k} \\\\\nv_{j,k} &= \\sigma_v v^{(z)}_{j,k} \\\\\np^{(z)}_k, \\alpha^{(z)}_k, u^{(z)}_{i,k},v^{(z)}_{j,k} &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma_p,\\sigma_{\\alpha},\\sigma_u, \\sigma_v &\\sim \\text{Exponential}(1)\n\\end{align}\n\\]\n\n\n\nNotation\nMeaning\n\n\n\n\n\\(\\pi_{ij,k}\\)\ntrue ecological interaction probability\n\n\n\\(p_k\\)\ndetection probability for web \\(k\\)\n\n\n\\(q_{ij,k}\\)\nprobability of observing interaction\n\n\n\\(\\alpha_k\\)\nbaseline interaction rate in web \\(k\\)\n\n\n\\(u_{i,k}\\)\nconsumer \\(i\\) feeding generality\n\n\n\\(v_{j,k}\\)\nresource \\(j\\) feeding vulnerability\n\n\n\\(\\mu_p\\)\noverall mean detection\n\n\n\\(\\sigma_p\\)\nbetween-web variation in detection\n\n\n\\(\\mu_{\\alpha}\\)\noverall mean interaction rate\n\n\n\\(\\sigma_{\\alpha}\\)\nbetween-web variation in interaction rate\n\n\n\\(*^{(z)}\\)\nstandardized, non-centered latent deviations\n\n\n\nThough this is an important advance, our detection probability is just another probability that we estimate. It is treated as a latent, random effect that accounts for false negatives. However, it might be reasonable to assume that detection is non-random: species with particular traits may be more readily observed. For example, if larger species are easier to sample, then we would detect their diets more often. To incorporate this, we make an adjustment to Equation 3. We have a few options here. First, let \\(M_i\\) and \\(M_j\\) be the log body masses of consumer \\(i\\) and resource \\(j\\).\n\n\n\nWe define a parameter \\(\\nu_k\\) which controls the effect of consumer body mass on detection.\n\\[\n\\begin{align}\n\\text{logit}(p_{i,k}) = \\mu_p + \\gamma_k M_i + \\sigma_p p^{(z)}_{i,k}\n\\end{align}\n\\]\nWhen \\(\\nu_k &gt; 0\\), the feeding links of larger species are detected more often. This model creates a serious confound: body mass effect on links and detection are competing, potentially making the probability \\(q_{ij,k}\\) unidentifiable.\n\n\n\nAn second approach that aligns with food web theory (Allesina 2011) might hypothesize that it is the ratio of \\(M_i\\) to \\(M_j\\) that influences detection. Since both covariates are on a log scale, we compute the difference between them and estimate the effect \\(\\nu_k\\).\n\\[\n\\begin{align}\n\\text{logit}(p_{ij,k}) &= \\mu_p + \\gamma_k (M_i - M_j) + \\sigma_p p^{(z)}_{ij,k}\n\\end{align}\n\\]\nThis does not magically remove the identifiability problem but it slices the variation differently such that we can attribute link variation associated with size ratio vs. detection that is associated with consumer body size.\n\n\n\nSimilar to the size-ratio model, a third option would be to focus on the absolute difference between the species body sizes. This means something quite difference biologically.\n\\[\n\\begin{align}\n\\text{logit}(p_{ij,k}) &= \\mu_p + \\gamma_k |M_i - M_j| + \\sigma_p p^{(z)}_{ij,k}\n\\end{align}\n\\]\nEach of the detection mechanisms contain very different assumptions about how detection scales body size.\n\nConsumer Size Model: This individual-level mechanism suggests that probability scales with the body size of the consumer, regardless of the size of the prey. Large predators are easier to observe and thus their feeding links are easier to detect.\nSize Ratio Model: This edge-level mechanisms suggests that the probability of observing a feeding link depends on the ratio of consumer to resource body size. Observing large predators feeding on smaller prey are more likely, whereas a predator which is much smaller than it prey are ecological unusual and difficult to detect. The detection probability of such unusual events is proportionally lower.\nSize Mismatch Model: This edge-level mechanism assumes that detection probability depends on the absolute difference between predators and prey. This mechanism does not imply that size mismatches are uncommon, only that such interactions leave evidence that is more difficult to detect."
  },
  {
    "objectID": "posts/2025-11-20-food-web-measurement-2/index.html#introduction",
    "href": "posts/2025-11-20-food-web-measurement-2/index.html#introduction",
    "title": "Food Web Generation and Measurement II",
    "section": "",
    "text": "In the previous post, we discussed how the probability of a feeding link between two species depends in part on the probability of detecting the link during the sampling effort. Accounting for this is an important step toward understanding whether the food web structure we are studying is due to ecological processes that underlie community assembly, or some sampling bias (or both).\nAs a reminder, our existing model treats the probability of an observed link in a web (\\(A_{ij,k}\\)) as\n\n\n\\[\n\\begin{align}\nA_{ij,k} &\\sim \\text{Bernoulli}(q_{ij,k}) \\\\\nq_{ij,k} &= p_k \\pi_{ij,k} \\\\\np_k &= \\text{logit}^{-1}(\\mu_{p} + \\sigma_p p^{(z)}_k) \\\\\n\\pi_{ij,k} &= \\text{logit}^{-1}(\\alpha_k + u_{i,k} + v_{j,k}) \\\\\n\\alpha_k &= \\mu_{\\alpha} + \\sigma_{\\alpha} \\alpha^{(z)}_k \\\\\nu_{i,k} &= \\sigma_u u^{(z)}_{i,k} \\\\\nv_{j,k} &= \\sigma_v v^{(z)}_{j,k} \\\\\np^{(z)}_k, \\alpha^{(z)}_k, u^{(z)}_{i,k},v^{(z)}_{j,k} &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma_p,\\sigma_{\\alpha},\\sigma_u, \\sigma_v &\\sim \\text{Exponential}(1)\n\\end{align}\n\\]\n\n\n\nNotation\nMeaning\n\n\n\n\n\\(\\pi_{ij,k}\\)\ntrue ecological interaction probability\n\n\n\\(p_k\\)\ndetection probability for web \\(k\\)\n\n\n\\(q_{ij,k}\\)\nprobability of observing interaction\n\n\n\\(\\alpha_k\\)\nbaseline interaction rate in web \\(k\\)\n\n\n\\(u_{i,k}\\)\nconsumer \\(i\\) feeding generality\n\n\n\\(v_{j,k}\\)\nresource \\(j\\) feeding vulnerability\n\n\n\\(\\mu_p\\)\noverall mean detection\n\n\n\\(\\sigma_p\\)\nbetween-web variation in detection\n\n\n\\(\\mu_{\\alpha}\\)\noverall mean interaction rate\n\n\n\\(\\sigma_{\\alpha}\\)\nbetween-web variation in interaction rate\n\n\n\\(*^{(z)}\\)\nstandardized, non-centered latent deviations\n\n\n\nThough this is an important advance, our detection probability is just another probability that we estimate. It is treated as a latent, random effect that accounts for false negatives. However, it might be reasonable to assume that detection is non-random: species with particular traits may be more readily observed. For example, if larger species are easier to sample, then we would detect their diets more often. To incorporate this, we make an adjustment to Equation 3. We have a few options here. First, let \\(M_i\\) and \\(M_j\\) be the log body masses of consumer \\(i\\) and resource \\(j\\).\n\n\n\nWe define a parameter \\(\\nu_k\\) which controls the effect of consumer body mass on detection.\n\\[\n\\begin{align}\n\\text{logit}(p_{i,k}) = \\mu_p + \\gamma_k M_i + \\sigma_p p^{(z)}_{i,k}\n\\end{align}\n\\]\nWhen \\(\\nu_k &gt; 0\\), the feeding links of larger species are detected more often. This model creates a serious confound: body mass effect on links and detection are competing, potentially making the probability \\(q_{ij,k}\\) unidentifiable.\n\n\n\nAn second approach that aligns with food web theory (Allesina 2011) might hypothesize that it is the ratio of \\(M_i\\) to \\(M_j\\) that influences detection. Since both covariates are on a log scale, we compute the difference between them and estimate the effect \\(\\nu_k\\).\n\\[\n\\begin{align}\n\\text{logit}(p_{ij,k}) &= \\mu_p + \\gamma_k (M_i - M_j) + \\sigma_p p^{(z)}_{ij,k}\n\\end{align}\n\\]\nThis does not magically remove the identifiability problem but it slices the variation differently such that we can attribute link variation associated with size ratio vs. detection that is associated with consumer body size.\n\n\n\nSimilar to the size-ratio model, a third option would be to focus on the absolute difference between the species body sizes. This means something quite difference biologically.\n\\[\n\\begin{align}\n\\text{logit}(p_{ij,k}) &= \\mu_p + \\gamma_k |M_i - M_j| + \\sigma_p p^{(z)}_{ij,k}\n\\end{align}\n\\]\nEach of the detection mechanisms contain very different assumptions about how detection scales body size.\n\nConsumer Size Model: This individual-level mechanism suggests that probability scales with the body size of the consumer, regardless of the size of the prey. Large predators are easier to observe and thus their feeding links are easier to detect.\nSize Ratio Model: This edge-level mechanisms suggests that the probability of observing a feeding link depends on the ratio of consumer to resource body size. Observing large predators feeding on smaller prey are more likely, whereas a predator which is much smaller than it prey are ecological unusual and difficult to detect. The detection probability of such unusual events is proportionally lower.\nSize Mismatch Model: This edge-level mechanism assumes that detection probability depends on the absolute difference between predators and prey. This mechanism does not imply that size mismatches are uncommon, only that such interactions leave evidence that is more difficult to detect."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Shane A. Scaggs",
    "section": "",
    "text": "I am a Postdoctoral Scholar in the Health and Environment Modeling Laboratory. My research combines approaches from anthropology, ecology, and data science to understand how humans, wildlife, and plants interact, and the complex patterns that emerge from these interactions."
  },
  {
    "objectID": "CV.html",
    "href": "CV.html",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "President’s Postdoctoral Scholar Health and Environment Modeling Laboratory Division of Biostatistics The Ohio State University scaggs.32@osu.edu"
  },
  {
    "objectID": "CV.html#shane-a.-scaggs",
    "href": "CV.html#shane-a.-scaggs",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "President’s Postdoctoral Scholar Health and Environment Modeling Laboratory Division of Biostatistics The Ohio State University scaggs.32@osu.edu"
  },
  {
    "objectID": "CV.html#research-interests",
    "href": "CV.html#research-interests",
    "title": "Curriculum Vitae",
    "section": "Research Interests",
    "text": "Research Interests\nEcological, Evolutionary, & Cultural Anthropology \\(\\times\\) Complex Adaptive Systems \\(\\times\\) Landscape, Community, & Theoretical Ecology \\(\\times\\) Computational Social Science \\(\\times\\) Bayesian Hierarchical Modeling"
  },
  {
    "objectID": "CV.html#professional-preparation",
    "href": "CV.html#professional-preparation",
    "title": "Curriculum Vitae",
    "section": "Professional Preparation",
    "text": "Professional Preparation\n\n\n\n\n\n\n\n2025\nPresident’s Postdoctoral Scholar\nHealth and Environment Modeling Laboratory, Division of Biostatistics, The Ohio State University, Columbus, OH\n\n\n\n\n\n\n2025\nPh.D. in Anthropology (advisor: Dr. Sean Downey)\nDepartment of Anthropology, The Ohio State University, Columbus, OH\nDissertation: “Rethinking the Socio-Ecology of Swidden Agriculture using Ecological Anthropology, Landscape and Community Ecology, and Complexity Theory”\n\n\n\n\n\n\n2018\nM.S. in Applied Anthropology (advisor: Dr. Drew Gerkey)\nSchool of Language, Culture, and Society, Oregon State University, Corvallis, OR\nThesis: “Subsistence Harvest Diversity in Alaskan Food Sharing Networks”\n\n\n\n\n\n\n2016\nB.S. in Anthropology (advisor: Dr. John Ziker)\nDepartment of Anthropology, Boise State University, Boise, ID"
  },
  {
    "objectID": "CV.html#publications",
    "href": "CV.html#publications",
    "title": "Curriculum Vitae",
    "section": "Publications",
    "text": "Publications\n\n\n\n\n\nYear\nCitation\n\n\n\n\nIn revision\nDowney, S. S., Tverskoi, D., Scaggs, S. A., Wu, X., Syed, Z., Lebowitz, J., Qin, R., Thurner, S. Signatures of adaptive self-organization detected in swidden societies worldwide. Proceedings of the National Academy of Sciences. \n\n\nIn revision\nScaggs, S. A., Downey S. S. Graduated sanctions, common pool resource management, and the social organization of labor in swidden agriculture. PLoS One. \n\n\n2025*\nDowney, S. S., Tverskoi, D., Scaggs, S. A., Wu, X., Syed, Z., Lebowitz, J., Qin, R., Thurner, S. Signatures of adaptive self-organization detected in swidden societies worldwide. bioRxiv,Cold Spring Harbor. https://doi.org/10.1101/2025.08.04.668537\n\n\n2025*\nScaggs, S.A., Wu, X., Syed, Z., Lebowitz, J., Qin, R., Downey, S. S. The Landscape Ecology of Swidden: A Global Comparison Indicates Swidden Landscape Mosaics Contribute to Vegetation Diversity at Intermediate Levels of Disturbance. bioRxiv,Cold Spring Harbor. https://doi.org/10.1101/2025.03.05.6415\n\n\n2025\nRao, S., Scaggs, S. A., Asuan, A., Roque, A.D. Power outages and social vulnerability in the US Gulf Coast: multilevel Bayesian models of outage durations amid rising extreme weather Humanities and Social Sciences Communications,12(1), 1-12. https://doi.org/10.1057/s41599-025-05274-0\n\n\n2025\nTverskoi, D., Scaggs, S. A., Downey, S. S. A complex adaptive systems model of labor reciprocity and normative reasoning in swidden agriculture. Royal Society Open Science,12(5), 242197 https://doi.org/10.1098/rsos.242197\n\n\n2024*\nTverskoi, D., Scaggs, S. A., Downey, S. S. A complex adaptive systems model of labor reciprocity and normative reasoning in swidden agriculture. bioRxiv,Cold Spring Harbor. https://www.biorxiv.org/content/early/2024/12/15/2024.12.12.628215.full.pdf\n\n\n2023\nRoss, C. T., Hooper, P., Smith, J. E., [and 101 others, including Scaggs, S. A.] Reproductive Inequality in Humans and Other Mammals. Proceedings of the National Academy of Sciences,120(22) e2220124120. https://doi.org/10.1073/pnas.2220124120\n\n\n2023\nDowney, S. S., Walker, M., Moschler, J., Penados, F., Peterman, W., Rongjun, Q., Scaggs, S. A., Song, S. An intermediate level of disturbance with customary agricultural practices increases species diversity in Maya community forests in Belize. Communications Earth and Environment,4(428). https://doi.org/10.1038/s43247-023-01089-6\n\n\n2022\nPiperata, B., Scaggs, S. A., Dufour, D., Adams, I. Measuring food security: An introduction to tools for human biologists and ecologists. American Journal of Human Biology,35(2). https://doi.org/10.1002/ajhb.23821\n\n\n2021\nScaggs, S. A., Gerkey, D., McLaughlin, K. Linking subsistence harvest diversity and productivity to adaptive capacity in an Alaskan food sharing network. American Journal of Human Biology. Special Issue: Anthropological Insights on Adaptation and Climate Change,33(4): e23573. https://doi.org/10.1002/ajhb.23573\n\n\n2021\nKawa, N., Arceno, M. A., Goeckner, R., Hunter, C., Rhue, S., Scaggs, S. A., Biwer, M., Downey, S., Field, J., Gremillion, K., McCorriston, J., Willow, A., Newton, E., Moritz, M. Training Wicked Scientists for a World of Wicked Problems. Humanities and Social Sciences Communications,8(189). https://doi.org/10.1057/s41599-021-00871-1\n\n\n2020\nDowney, S., Gerkey, D., Scaggs, S. A. The Milpa Game: a field experiment investigating the social and ecological dynamics of Q'eqchi' Maya swidden agriculture. Human Ecology,48(4). https://doi.org/10.1007/s10745-020-00169-x\n\n\n2020\nMoritz, M., Scaggs, S. A., Shapiro, C., Hinkelman, S. Comparative Study of Territoriality across Forager Societies. Human Ecology,48(2). https://doi.org/10.1007/s10745-020-00141-9\n\n\n2019\nSnopkowski, K., Demps, K., Scaggs, S. A., Griffiths, R., Fulk, K., May, S., Neagle, K., Downs, K., Eugster, M., Amend, T., Heath, J. Small Group Learning is Associated with Reduced Salivary Cortisol and Testosterone in Undergraduate Students. Journal of the Scholarship of Teaching and Learning,19(5). https://doi.org/10.14434/josotl.v19i5.24230.\n\n\n2017\nScaggs, S. A., Fulk, K., Glass, D. J., Ziker, J. P. Framing charitable solicitation in a behavioral experiment: Cues derived from evolutionary theory of cooperation and anthropological economics. In Li, M., Tracer, D. P. (eds.) Interdisciplinary Perspectives on Fairness, Equity, and Justice, 153-178. Springer. https://doi.org/10.1007/978-3-319-58993-0_10"
  },
  {
    "objectID": "CV.html#contributions",
    "href": "CV.html#contributions",
    "title": "Curriculum Vitae",
    "section": "Contributions",
    "text": "Contributions\n\n\n\n\n\nContribution matrix."
  },
  {
    "objectID": "CV.html#awards-fellowships-and-funding-support",
    "href": "CV.html#awards-fellowships-and-funding-support",
    "title": "Curriculum Vitae",
    "section": "Awards, Fellowships, and Funding Support",
    "text": "Awards, Fellowships, and Funding Support\n\n\n\n\n\nYear\nAward\n\n\n\n\n2025\nThe CAPS Award for Exceptional Policy Analysis in a Poster -- The Computational Social Science Society of the Americas.\n\n\n2025\nOutstanding Dissertation Award -- Department of Anthropology, The Ohio State University.\n\n\n2024\nPresidential Fellowship -- The Ohio State University.\n\n\n2021\nDoctoral Dissertation Research: Subsistence Hunting in an Anthropogenic Swidden Landscape in Southern Belize -- Cultural Anthropology Program, National Science Foundation. Downey, S. S. (PI), Scaggs, S. A. (Co-PI).\n\n\n2019\nDaniel T. Hughes Memorial Fund -- Department of Anthropology, The Ohio State University.\n\n\n2019\nPre-Dissertation Field Research Grant -- Tinker Foundation, College of Latin American Studies, The Ohio State University.\n\n\n2018\nGraduate Research Fellowship -- Graduate Research Fellowship Program, National Science Foundation.\n\n\n2018\nGraduate Research and Writing Residency -- Spring Creek Project, Oregon State University.\n\n\n2015\nSpecial Undergraduate Recognition Award -- Evolutionary Anthropology Society, American Anthropological Association."
  },
  {
    "objectID": "CV.html#conference-proceedings",
    "href": "CV.html#conference-proceedings",
    "title": "Curriculum Vitae",
    "section": "Conference Proceedings",
    "text": "Conference Proceedings\n\n\n\n\n\nYear\nPresentation\n\n\n\n\n2025\nTverskoi, D., Scaggs, S., Downey, S. A Complex Adaptive Systems Model of Labour Reciprocity and Normative Reasoning in Swidden Agriculture. 13th Annual Meeting, The Computational Social Science Society of the Americas, Santa Fe, NM. Poster.\n\n\n2025\nScaggs, S. A. Comparing the structure of swidden agricultural mosaics throughout the world's tropical forests. 94th Annual Meeting, American Association of Biological Anthropologists, Baltimore, MD. Poster.\n\n\n2024\nScaggs, S. A. Intermediate-scale swidden disturbances increase forest diversity in Inidgenous Maya community forests. 84th Annual Meeting, Society for Applied Anthropology, Santa Fe, NM. Podium.\n\n\n2023\nScaggs, S. A. Human Influences on the Structure of Central American Food Webs. 83rd Annual Meeting, Society for Applied Anthropology, Cincinnati, OH. Podium.\n\n\n2021\nScaggs, S. A., Shen, A., Downey, S. S. The Importance of Humans in Neotropical Food Webs. Fall Forum 2021, Translational Data Analytics. Poster.\n\n\n2021\nScaggs, S. A., Gerkey, D. Subsistence harvest diversity, social networks, and adaptive capacity to environmental change in Alaska. 90th Annual Meeting, American Association of Biological Anthropologists, Virtual. Invited Symposium.\n\n\n2019\nScaggs, S. A. Playing 'The Milpa Game': Using field experpiments to investigate common pool resource dilemmas in Toledo District, Belize. 118th Annual Meeting, American Anthropological Association. Vancouver, BC. Podium.\n\n\n2018\nScaggs, S. A. Subsistence harvest productivity and biodiversity in Alaskan social networks. 117th Annual Meeting, American Anthropological Association. San Jose, CA. Podium.\n\n\n2018\nScaggs, S. A. Exponential random graph modeling of productivity, diversity, and reciprocity in Alaskan food sharing networks. 5th Annual Northwest Evolution, Ecology, and Human Behavior Symposium. Boise, ID. Poster.\n\n\n2017\nScaggs, S. A., Gerkey, D. Dynamic Change, Social Networks, and Harvests: Levels of Resilience in Alaska. 29th Annual Meeting, Human Behavior and Evolution Society. Poster.\n\n\n2017\nSnopkowski, K., Demps, K., Scaggs, S. A., Griffiths, R. Fulk, K. S., May, S., Neagle, K., Downs, K., Eugster, M., Amend, T .Stress: The effects of social and solitary learning on salivary hormones. 29th Annual Meeting, Human Behavior and Evolution Society. Boise, ID. Poster.\n\n\n2016\nScaggs, S. A. The Solicitation of Charitable Donations: Experimental Evidence from Behavioral Economic Games. Boise State University Undergraduate Research Conference. Podium.\n\n\n2016\nScaggs, S. A., Glass, D. J. Understanding Charitable Donations. Boise State University Advancement Team. Invited Talk.\n\n\n2016\nSnopkowski, K., Demps, K., Scaggs, S. A., Griffiths, R. Fulk, K. S., May, S., Neagle, K., Downs, K., Eugster, M., Amend, T. Endocrine stress response in college students to solitary and group learning. 4th Northwest Evolution, Ecology, and Human Behavior Symposium. Boise, ID. Poster.\n\n\n2016\nScaggs, S. A., Glass, D. J., Ziker, J. Four Pathways to Generosity. 4th Northwest Evolution, Ecology, and Human Behavior Symposium. Boise, ID. Poster.\n\n\n2015\nScaggs, S. A., Glass, D. J. Four Pathways to Generosity: Evolutionary Mechanisms Differentially Affect Charitable Donations. 114th Annual Meeting, American Anthropological Association. Denver, CO. Podium."
  },
  {
    "objectID": "CV.html#professional-development",
    "href": "CV.html#professional-development",
    "title": "Curriculum Vitae",
    "section": "Professional Development",
    "text": "Professional Development\n\n\n\n\n\n\n\n2024\nComplex Systems Summer School\nSanta Fe Institute – Santa Fe, NM"
  },
  {
    "objectID": "CV.html#teaching-experience",
    "href": "CV.html#teaching-experience",
    "title": "Curriculum Vitae",
    "section": "Teaching Experience",
    "text": "Teaching Experience\n\n\n\n\n\nTerm\nCourse\nInstitution\nLevel\n\n\n\n\nSpring 2023\nData Science for Anthropology\nOhio State University\n8000\n\n\nSummer 2022\nIntroduction to Cultural Anthropology\nOhio State University\n2000\n\n\nSpring 2018\nHuman Evolution\nOregon State University\n4000\n\n\nWinter 2018\nAnthropology, Health, and Environment\nOregon State University\n3000\n\n\nAutumn 2017\nComparative Cultures\nOregon State University\n2000\n\n\nSpring 2017\nHuman Evolution\nOregon State University\n4000\n\n\nWinter 2017\nComparative Cultures\nOregon State University\n2000\n\n\nAutumn 2016\nComparative Cultures\nOregon State University\n2000\n\n\n\n\n\n\nService and Outreach\n\n\n\n\n\nYear\nRole\n\n\n\n\n2022-2025\nReviewer. Human Ecology.\n\n\n2023\nReviewer. NSF Arctic Social Sciences Program.\n\n\n2023\nSession Chair, \"Cultural practices and social organization shape community responses to environmental and ecological shocks \", Society for Applied Anthropology, Cincinnati, OH.\n\n\n2020-2023\nFounder. Social Ecological Networks Groups (SENG). A collective learning and research group focused on using R and Python to study Social Ecological Networks. https://seng.netlify.app\n\n\n2020 - 2021\nPodcast host, \"A Story of Us, Ohio State Anthropology Public Outreach Program\n\n\n2019\nSession Chair, \"Precariously in Place: Ecological Knowledge and Navigating Climate Change\", Anthropology and Environment Society, 118th American Anthropological Association Meeting, Vancouver, BC\n\n\n2017\nConference Volunteer, 29th Human Behavior and Evolution Society Meeting, Boise, ID\n\n\n2016\nSymposium Volunteer, 4th Northwest Evolution, Ecology, and Human Behavior Symposium, Boise, ID\n\n\n2015\nSymposium Volunteer, 3rd Northwest Evolution, Ecology, and Human Behavior Symposium, Boise, ID\n\n\n2015\nVolunteer Field Assistant, Golden eagle banding and nestling survey, Boise State University, Department of Biological Sciences\n\n\n2015\nVolunteer Field Assistant, Barn owl banding and nestling survey, Boise State University, Department of Biological Sciences\n\n\n2015\nConference Volunteer, 81st American Physical Anthropology Assocation Meeting, Portland, OR\n\n\n2012\nConference Volunteer, 114th American Anthropological Association Meeting, Denver, CO"
  },
  {
    "objectID": "gallery.html",
    "href": "gallery.html",
    "title": "Data Visualization Gallery",
    "section": "",
    "text": "Three decades of Saguaro cactus surveys at Saguaro National Park. Top: a lollipop graph showing the research effort put into surveyed Saguaro. Bottom: annual growth in inches for all saguaro surveyed and the average growth trend from 1980 to 2010. Data from Orum, Ferguson, & Mihail (2016). “Saguaro (Carnegiea gigantea) Mortality and Population Regeneration in the Cactus Forest of Saguaro National Park: Seventy-Five Years and Counting”. PLOS One. https://doi.org/10.1371/journal.pone.0160899"
  },
  {
    "objectID": "posts/2025-11-17-food-web-measurement/index.html",
    "href": "posts/2025-11-17-food-web-measurement/index.html",
    "title": "Food Web Generation and Measurement I",
    "section": "",
    "text": "Food webs are often represented as network graphs, where nodes represent species and links represent observed feeding interactions, or potential feeding interactions inferred from species traits. The Web of Life database houses many such graphs, showcasing their interesting structural patterns and the tremendous efforts ecologists have gone to in order to collect these challenging data.\nA particular challenge when collecting food web data is knowing whether sampling effort is sufficient. Consider the implications of missing some feeding links. If an interaction involving even a single rare species goes unobserved, it can impact the overall network structure. Since many theories of food webs focus directly on explaining the structure of food webs, measurement models are needed that can help us infer whether the observed structure results from fundamental processes of community assembly or from partial sampling. In this blog post, we explore this measurement problem and develop some preliminary simulations and validations.\nTo begin, let’s lay out a basic model. Let’s assume that we want to infer species interactions using a hierarchical model (multiple food webs). This let’s us pool information from across multiple webs to understand our ability to detect trophic links.\nFor each food web \\(k = 1,...,K\\), we observe pairs of species interactions \\(A^{\\text{obs}}_{ij,k} \\in \\{0,1\\}\\). A value of \\(1\\) indicates the presence of a link between \\(i \\rightarrow j\\). Given this, we model the probability of a link \\(\\pi_{ij,k}\\) as\n\\[\n\\begin{equation}\n\\text{logit}(\\pi_{ij,k}) = \\alpha_k + u_{i,k} + v_{j,k}\n\\end{equation}\n\\]\nwhere \\(\\alpha_k\\) is a baseline interaction rate for web \\(k\\), and \\(u_{i,k}\\) and \\(v_{j,k}\\) are consumer- and resource-specific random effects. We could then say that the “true” set of interactions is Bernoulli distributed\n\\[\n\\begin{equation}\nA^{\\text{obs}}_{ij,k} \\sim \\text{Bernoulli}(\\pi_{ij,k})\n\\end{equation}\n\\] In other words, there is a probability \\(\\pi_{ij,k}\\) that we observe a link between \\(ij\\) in food web \\(k\\). Such a probability could be directly computed from \\(A\\). But if sampling is biased, then this probability will inherit this bias. For this reason, we also need a detection model.\n\\[\n\\begin{equation}\n\\text{logit}(p_k) = \\mu_p + \\sigma_p p^{(z)}_k\n\\end{equation}\n\\]\nWe assume that each web has its own rate of detection \\(p_k\\). The parameter \\(\\mu_p\\) is the average log-odds of detection across all food webs with a specific deviation of web \\(k\\) from the global average, which we model as non-centered: \\(\\sigma_p p^{(z)}_k\\).\nIt follows that the probability of observing a link is\n\\[\n\\begin{equation}\nq_{ij,k} = p_k \\cdot \\pi_{ij,k}\n\\end{equation}\n\\] We use this to amend our original likelihood to\n\\[\n\\begin{equation}\nA^{\\text{obs}}_{ij,k} \\sim \\text{Bernoulli}(q_{ij,k})\n\\end{equation}\n\\]\nIn essence, this model assumes that\n\nIf \\(A^{\\text{true}}_{ij,k} = 0\\), then \\(A^{\\text{obs}}_{ij,k} = 0\\).\nIf \\(A^{\\text{true}}_{ij,k} = 1\\), then we observe \\(A^{\\text{obs}}_{ij,k} = 1\\) with probability \\(\\pi_{ij,k}\\).\n\nAlthough false positives are also a possible source of bias, we leave this out of the model, for now.\nFinally, we need to declare hierarchical, non-centered priors for all parameters, beginning first with the interaction rates, then the detection probabilities, and finally the random effects. We assume a weakly informative \\(\\mathcal{N}(0,1)\\) prior on all latent deviations, and \\(\\text{Exponential}(1)\\) for all SD."
  },
  {
    "objectID": "posts/2025-11-17-food-web-measurement/index.html#simulation",
    "href": "posts/2025-11-17-food-web-measurement/index.html#simulation",
    "title": "Food Web Generation and Measurement I",
    "section": "Simulation",
    "text": "Simulation\nTo test this model, we need to simulate food webs to serve as the “true” sets of interactions, and “observe” our food webs probabilistically from them. Here are the packages used in this workflow.\n\nlibrary(tidyverse)\nlibrary(tidygraph)\nlibrary(ggraph)\nlibrary(graphlayouts)\nlibrary(igraph)\nlibrary(patchwork)\nlibrary(latex2exp)\n\nWe begin by setting up our parameters.\n\n# ---- Setup ----\nset.seed(777)\ninv_logit = function(x) exp(x) / (1 + exp(x))\n\n# ---- Parameters ----\nK = 3   \nS = 30\nmu_alpha = -2\nsigma_alpha = 1\nsigma_u = 2\nsigma_v = 1\nmu_p = -1\nsigma_p = 0.5\n\n# generate varying base rates and detection probabilities \nalpha_k = rnorm(K, mu_alpha, sigma_alpha); alpha_k\n\n[1] -1.510214 -2.398541 -1.489164\n\np_k = inv_logit(rnorm(K, mu_p, sigma_p)); p_k\n\n[1] 0.2315809 0.4549582 0.3341748\n\n\nWe then set up some containers for the simulation results.\n\n# ---- Outputs ----\nA_true = array(0, dim = c(S,S,K))\nA_obs  = array(0, dim = c(S,S,K))\n\nThe basic procedure is the following:\n\nGenerate \\(u_{i,k}\\) and \\(v_{j,k}\\).\nCreate \\(S \\times S\\) matrices for the “true” and “observed” webs.\nGenerate \\(\\pi_{ij,k}\\) based on \\(\\alpha_k\\) + random effects.\nAdjust observed links based on \\(p_k \\cdot \\pi_{ij,k}\\).\n\n\nfor(k in 1:K) {\n  \n  # Random effects\n  u_i = rnorm(S, mean = 0, sd = sigma_u)\n  v_j = rnorm(S, mean = 0, sd = sigma_v)\n  \n  # Loop \n  for(i in 1:S) for(j in 1:S) {\n    \n    pi_ijk = inv_logit(alpha_k[k] + u_i[i] + v_j[j])\n    \n    A_true[i,j,k] = rbinom(1, 1, pi_ijk)\n    A_obs[i,j,k] = rbinom(1, 1, p_k[k] * pi_ijk)\n  }\n}\n\nThis yields the following summary.\n\ndat = data.frame(\n  web            = 1:K, \n  true_links     = apply(A_true, 3, sum), \n  observed_links = apply(A_obs,  3, sum), \n  detection      = p_k, \n  alpha          = alpha_k\n); dat\n\n  web true_links observed_links detection     alpha\n1   1        297             55 0.2315809 -1.510214\n2   2        124             49 0.4549582 -2.398541\n3   3        185             66 0.3341748 -1.489164\n\n\nIf we examine the degree distributions across all of the webs, we can see how they differ after we adjust for the probability of detection.\n\ndeg = function(A) apply(A, 3, function(mat) rowSums(mat)) |&gt;  as.vector()\n\ndata.frame(\n  True      = deg(A_true),\n  Observed  = deg(A_obs)\n) |&gt; \n  gather(key = key, value = degree) |&gt; \n  ggplot(aes(degree)) + \n  geom_histogram(color='white', fill='black') + \n  facet_wrap(~key) + \n  labs(x = 'Outgoing links', y = 'Count')\n\n\n\n\nThe out-degree distribution across all simulated webs.\n\n\n\n\nWe can see that the degree distribution of the observed links is more zero-inflated and that the tail of the distribution has contracted. Altering the values of \\(\\sigma_u\\) and \\(\\sigma_v\\) can change these properties to some extent, especially the heaviness of the tail.\n\nA_true1 = A_true[,,1]\nA_obs1  = A_obs[,,1]\n\nrow_sums = rowSums(A_true1)\nsort_order = order(row_sums)\n\npar(mfrow=c(1,2))\nimage(A_true1[sort_order, sort_order], \n      col = c('black','tomato'), \n      main = 'True', \n      xaxt = 'n', yaxt = 'n')\nimage(A_obs1[sort_order, sort_order],  \n      col = c('black','tomato'), \n      main = 'Observed', \n      xaxt = 'n', yaxt = 'n')\n\n\n\n\nExamples of true and observed adjacency matrices.\n\n\n\n\n\nModel Validation\nThe next step is to develop the hierarchical model in Stan and validate it using the true and observed interaction matrices. First, we define the model block to mirror our simulation and the model notation. This block include the priors for all parameters and hyperparameters.\nmodel {\n  // priors for latent z-parameters \n  p_z ~ normal(0,1); \n  alpha_z ~ normal(0,1);\n  to_vector(u_z) ~ normal(0,1); \n  to_vector(v_z) ~ normal(0,1); \n  \n  //priors for hyperparameters \n  mu_p ~ normal(0,1);\n  sigma_p ~ exponential(1);\n  mu_alpha ~ normal(0,1);\n  sigma_alpha ~ exponential(1); \n  sigma_u ~ exponential(1);\n  sigma_v ~ exponential(1);\n  \n  // likelihood \n  for(k in 1:K) {\n    // detection random effect\n    real p_k = inv_logit(mu_p + sigma_p * p_z[k]);\n    \n    // link random effect\n    real alpha_k = mu_alpha + sigma_alpha * alpha_z[k]; \n    \n    for(i in 1:N_cons) {\n      // consumer random effects \n      real u_ik = sigma_u * u_z[i,k];\n      \n      for(j in 1:N_res) {\n        // resource random effect \n        real v_jk = sigma_v * v_z[j,k];\n        \n        // link probability \n        real pi_ijk = inv_logit(alpha_k + u_ik + v_jk);\n        \n        // detection adjusted probability \n        real q_ijk = p_k * pi_ijk;\n        \n        // likelihood\n        A[i,j,k] ~ bernoulli(q_ijk);\n      }\n    }\n  }\n}\nFor all parameters that have priors, we declare them in the parameters block.\nparameters {\n  vector[K] p_z;\n  vector[K] alpha_z;\n  matrix[N_cons, K] u_z;\n  matrix[N_res, K] v_z;\n  \n  real mu_p; \n  real&lt;lower=0&gt; sigma_p; \n  real mu_alpha; \n  real&lt;lower=0&gt; sigma_alpha; \n  real&lt;lower=0&gt; sigma_u; \n  real&lt;lower=0&gt; sigma_v;\n}\nFinally, we set up the data needed for the model.\n\ndata_list = list(\n  N_cons = S, \n  N_res  = S, \n  K      = K, \n  A      = A_obs\n)\n\nThis corresponds to\ndata {\n  int&lt;lower=1&gt; N_cons;\n  int&lt;lower=1&gt; N_res;\n  int&lt;lower=1&gt; K;\n  // observed adjacency\n  array[N_cons, N_res, K] int&lt;lower=0, upper=1&gt; A; \n}\nView the full stan model.\n\ndata {\n  int&lt;lower=1&gt; N_cons;\n  int&lt;lower=1&gt; N_res;\n  int&lt;lower=1&gt; K;\n  // observed adjacency\n  array[N_cons, N_res, K] int&lt;lower=0, upper=1&gt; A; \n}\n\n\nparameters {\n  // non-centered latent effects\n  vector[K] p_z;\n  vector[K] alpha_z;\n  matrix[N_cons, K] u_z;\n  matrix[N_res, K] v_z;\n  \n  // hyperparameters\n  real mu_p; \n  real&lt;lower=0&gt; sigma_p; \n  real mu_alpha; \n  real&lt;lower=0&gt; sigma_alpha; \n  real&lt;lower=0&gt; sigma_u; \n  real&lt;lower=0&gt; sigma_v;\n}\n\nmodel {\n  // priors for latent z-parameters \n  p_z ~ normal(0,1); \n  alpha_z ~ normal(0,1);\n  to_vector(u_z) ~ normal(0,1); \n  to_vector(v_z) ~ normal(0,1); \n  \n  //priors for hyperparameters \n  mu_p ~ normal(0,1);\n  sigma_p ~ exponential(1);\n  mu_alpha ~ normal(0,1);\n  sigma_alpha ~ exponential(1); \n  sigma_u ~ exponential(1);\n  sigma_v ~ exponential(1);\n  \n  // likelihood \n  for(k in 1:K) {\n    // detection random effect\n    real p_k = inv_logit(mu_p + sigma_p * p_z[k]);\n    \n    // link random effect\n    real alpha_k = mu_alpha + sigma_alpha * alpha_z[k]; \n    \n    for(i in 1:N_cons) {\n      // consumer random effects \n      real u_ik = sigma_u * u_z[i,k];\n      \n      for(j in 1:N_res) {\n        // resource random effect \n        real v_jk = sigma_v * v_z[j,k];\n        \n        // link probability \n        real pi_ijk = inv_logit(alpha_k + u_ik + v_jk);\n        \n        // detection adjusted probability \n        real q_ijk = p_k * pi_ijk;\n        \n        // likelihood\n        A[i,j,k] ~ bernoulli(q_ijk);\n      }\n    }\n  }\n}\nAfter saving this model, we fit it using cmdstanr like so. This model samples in under a minute with 4 parallel chains when S = 30 and K = 3.\n\nlibrary(cmdstanr)\nmod &lt;- cmdstan_model(\"detection_model.stan\")\n\nfit1 &lt;- mod$sample(\n  data = data_list,\n  seed = 123,\n  chains = 4,\n  parallel_chains = 4,\n  adapt_delta = 0.95\n)\n\nfit$save_output_files()\n\nOur primary task is to determine whether the model can recover the parameters that we used within the simulation. Two focal parameters are the baseline interaction probability \\(\\alpha_k\\) and the detection probability \\(p_k\\). As a reminder, we generated these values by setting a \\(\\mu*\\) and \\(\\sigma*\\) for each and then drawing them K times.\n\nfocal_pars = data.frame(k = factor(1:k), alpha_k, p_k)\nfocal_pars\n\n  k   alpha_k       p_k\n1 1 -1.510214 0.2315809\n2 2 -2.398541 0.4549582\n3 3 -1.489164 0.3341748\n\n\nSince we modeled these as non-centered parameters, we need to reconstruct them from the draws. We will do this using the tidybayes package for handling Bayesian models in R.1 Let’s start with \\(\\alpha_k\\). We will generate a predicted \\(\\hat{\\alpha}_k\\) by pulling out alpha_z[k], mu_alpha, and sigma_alpha and the computing alpha_k_hat.\n\nlibrary(tidybayes)\n\nalpha_k_draws = fit1 |&gt; \n  spread_draws(mu_alpha, sigma_alpha, alpha_z[k]) |&gt;\n  group_by(k) |&gt; \n  mutate(alpha_k_hat = mu_alpha + sigma_alpha * alpha_z) \n\nWe can summarize the posterior distribution in many ways. Here I will plot this distribution and overlay the original values.\n\n\n\n\n\nComparison of predicted \\(\\hat{\\alpha}_k\\) to the input values of \\(\\alpha_k\\) (magenta \\(*\\)). Points are posterior means, and bars are 67% and 90% highest density posterior intervals.\n\n\n\n\n\\(\\hat{\\alpha}_k\\) falls within the density intervals in all cases, and comes extremely close to the mean for webs 1 and 3. We can now do this same to compute \\(\\hat{p}_k\\), though in this case we need to transform the model parameters from the log-odds scale to a probability scale.\n\np_k_draws = fit1 |&gt; \n  spread_draws(p_z[k], sigma_p, mu_p) |&gt; \n  group_by(k) |&gt; \n  mutate(p_k_hat = inv_logit(mu_p + sigma_p*p_z))\n\np_k_draws |&gt; \n  ggplot(aes(x=p_k_hat, y=factor(k))) + \n  stat_pointinterval(color='black', .width=c(0.67,0.9)) + \n  labs(x = TeX(\"$\\\\hat{p}_k$\"), y = 'k') + \n  geom_point(data=focal_pars, \n             aes(x = p_k, y=k), \n             color = 'white', pch=8, size=4, stroke=2) +\n  geom_point(data=focal_pars, \n             aes(x = p_k, y=k), \n             color = 'cyan3', pch=8, size=2, stroke=2)\n\n\n\n\nComparison of predicted \\(\\hat{p}_k\\) to the input values of \\(p_k\\) (cyan \\(*\\)). Points are posterior means, and bars are 67% and 90% highest density posterior intervals.\n\n\n\n\nAgain we come very close to recovering the true parameters, with the biggest difference being in web 2. Although we can certainly be more precise, this is still a good sign that the model could, in principle, estimate the latent detection probability \\(p_k\\)."
  },
  {
    "objectID": "posts/2025-11-17-food-web-measurement/index.html#non-random-links",
    "href": "posts/2025-11-17-food-web-measurement/index.html#non-random-links",
    "title": "Food Web Generation and Measurement I",
    "section": "Non-Random Links",
    "text": "Non-Random Links\nNow that we have a basic model and simulation skeleton, we should consider which traits might lead to a species having more or less feeding links. For example, we could expect that larger species may have broader diets. This idea has be presented many times, with notable examples coming from Petchey et al. (2008) and Allesina (2011). Here we can make a simplistic assumption that the mass of a consumer \\(M_i\\) can have a linear, additive effect on the probability of a link.2\n\\[\n\\begin{equation}\n\\text{logit}(\\pi_{ij,k}) = \\alpha_k + (u_{i,k} + b M_i) + v_{j,k}\n\\end{equation}\n\\]\nRather than having a single parameter \\(b\\) for all webs, it is more likely that we have distinct allometric relationships per web, because each simulated web could represent a distinct ecological community. This implies a random slopes model:\n\\[\n\\begin{align}\n\\text{logit}(\\pi_{ij,k}) &= \\alpha_k + (u_{i,k} + b_k M_{i,k}) + v_{j,k} \\\\\nb_k &= \\mu_b + \\sigma_b b^{(z)}_k \\\\\n\\mu_b &\\sim \\mathcal{N}(0,1) \\\\\nb^{(z)}_k &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma_b &\\sim \\text{Exponential}(1) \\\\\n\\end{align}\n\\]\nwhere \\(i \\in \\{1,...,S\\}\\) and \\(k \\in \\{1,...,K\\}\\). This means that \\(i\\) in web \\(k = 1\\) is not the same as \\(i\\) in web \\(k = 2\\).\n\n# ---- Setup ----\nset.seed(777)\ninv_logit = function(x) exp(x) / (1 + exp(x))\n\n# ---- Parameters ----\nK = 3   \nS = 30\nmu_alpha = -2\nsigma_alpha = 1\nsigma_u = 2\nsigma_v = 1\nmu_p = -1\nsigma_p = 0.5\nmu_b = 1\nsigma_b = 0.3\n\n# consumer mass \nM = matrix(NA_real_, nrow = S, ncol = K)\n\n# generate varying base rates and detection probabilities, and body mass effects \nalpha_k = rnorm(K, mu_alpha, sigma_alpha)\np_k = inv_logit(rnorm(K, mu_p, sigma_p))\nb_k = rnorm(K, mu_b, sigma_b)\n\n# ---- Outputs ----\nA_true = array(0, dim = c(S,S,K))\nA_obs  = array(0, dim = c(S,S,K))\nA_Mtrue = array(0, dim = c(S,S,K))\nA_Mobs  = array(0, dim = c(S,S,K))\n\n\nfor(k in 1:K) {\n  # Random effects\n  u_i = rnorm(S, mean = 0, sd = sigma_u)\n  v_j = rnorm(S, mean = 0, sd = sigma_v)\n  \n  \n    # Mass \n    mass_k = exp(rnorm(S, mu_b, sigma_b))\n    M[,k] = log(mass_k)\n  \n  # Loop \n  for(i in 1:S) for(j in 1:S) {\n    \n    pi_ijk = inv_logit(alpha_k[k] + u_i[i] + v_j[j])\n    A_true[i,j,k] = rbinom(1, 1, pi_ijk)\n    A_obs[i,j,k] = rbinom(1, 1, p_k[k] * pi_ijk)\n    \n    # body mass model \n    .pi_ijk = inv_logit(alpha_k[k] + (u_i[i] + b_k[k] * M[i,k]) + v_j[j])\n    A_Mtrue[i,j,k] = rbinom(1, 1, .pi_ijk)\n    A_Mobs[i,j,k] = rbinom(1, 1, p_k[k] * .pi_ijk)\n    \n  }\n}\n\nClearly the choice of the distribution of body masses will have an influence over this simulation. Here I assume that body masses are heavy-tailed and that we model them on a log-scale. For example, the code above gives the following:\n\ndata.frame(mass_k) |&gt;  \n  ggplot(aes(x=mass_k)) +  \n  stat_density(adjust = 0.5) + \n  labs(x=expression(M[i])) + \n  ggtitle('Raw mass') + \n\ndata.frame(M=M[,1]) |&gt;  \n  ggplot(aes(x=M)) +  \n  stat_density(adjust = 0.5) + \n  labs(x=expression(log(M[i]))) + \n  ggtitle('Log transformed') \n\n\n\n\n\n\n\n\n\nA_true1  = A_true[,,1]\nA_obs1   = A_obs[,,1]\nA_Mtrue1 = A_Mtrue[,,1]\nA_Mobs1  = A_Mobs[,,1]\n\nrow_sums = rowSums(A_true1)\nsort_order = order(row_sums)\n\npar(mfrow=c(2,2), mar=c(3,1,3,1))\nimage(A_true1[sort_order, sort_order], col = c('black','tomato'), main = 'True', xaxt = 'n', yaxt = 'n')\nimage(A_obs1[sort_order, sort_order],  col = c('black','tomato'), main = 'Observed', xaxt = 'n', yaxt = 'n')\n\nrow_sums = rowSums(A_Mtrue1)\nsort_order = order(row_sums)\n\nimage(A_Mtrue1[sort_order, sort_order], col = c('black','tomato'), main = 'True (Allometric)', xaxt = 'n', yaxt = 'n')\nimage(A_Mobs1[sort_order, sort_order],  col = c('black','tomato'), main = 'Observed (Allometric)', xaxt = 'n', yaxt = 'n')\n\n\n\n\n\n\n\n\nThe effect of body mass concentrates the true links toward the largest species. It is also gravitational: energy, in the form of biomass, flows toward these largest species. The effect of this on the observed links is very subtle but not entirely absent.\n\nlo = layout_as_tree(graph_from_adjacency_matrix(A_Mobs1))\npar(mfrow=c(2,2), mar=c(3,1,3,1))\nplot(graph_from_adjacency_matrix(A_true1),  \n     edge.arrow.size=0.2, \n     vertex.color = 'white', \n     vertex.label = NA, \n     layout = lo, \n     main = 'True')\nplot(graph_from_adjacency_matrix(A_obs1),   \n     edge.arrow.size=0.2, \n     vertex.color = 'white', \n     vertex.label = NA, \n     layout = lo, \n     main = 'Observed')\nplot(graph_from_adjacency_matrix(A_Mtrue1), \n     edge.arrow.size=0.2, \n     vertex.color = 'white', \n     vertex.label = NA, \n     layout = lo, \n     main = 'True (Allometric)')\nplot(graph_from_adjacency_matrix(A_Mobs1),  \n     edge.arrow.size=0.2, \n     vertex.color = 'white', \n     vertex.label = NA, \n     layout = lo, \n     main = 'Observed (Allometric)')\n\n\n\n\n\n\n\n\n\nStan model\nNow we adjust the original Stan model to include these biomass effects. The main changes, besides adding the non-centered effects of \\(b_k\\), are to include the body mass matrix M.\n\ndata {\n  int&lt;lower=1&gt; N_cons;\n  int&lt;lower=1&gt; N_res;\n  int&lt;lower=1&gt; K;\n  matrix[N_cons,K] M;\n  // observed adjacency\n  array[N_cons, N_res, K] int&lt;lower=0, upper=1&gt; A; \n}\n\n\nparameters {\n  // body mass slopes \n  vector[K] b_z;\n  real mu_b;\n  real&lt;lower=0&gt; sigma_b;\n  \n  // non-centered latent effects\n  vector[K] p_z;\n  vector[K] alpha_z;\n  matrix[N_cons, K] u_z;\n  matrix[N_res, K] v_z;\n  \n  // hyperparameters\n  real mu_p; \n  real&lt;lower=0&gt; sigma_p; \n  real mu_alpha; \n  real&lt;lower=0&gt; sigma_alpha; \n  real&lt;lower=0&gt; sigma_u; \n  real&lt;lower=0&gt; sigma_v;\n}\n\nmodel {\n  // b priors\n  b_z ~ normal(0,1);\n  mu_b ~ normal(0,1); \n  sigma_b ~ exponential(1);\n  \n  // priors for latent z-parameters \n  p_z ~ normal(0,1); \n  alpha_z ~ normal(0,1);\n  to_vector(u_z) ~ normal(0,1); \n  to_vector(v_z) ~ normal(0,1); \n  \n  //priors for hyperparameters \n  mu_p ~ normal(0,1);\n  sigma_p ~ exponential(1);\n  mu_alpha ~ normal(0,1);\n  sigma_alpha ~ exponential(1); \n  sigma_u ~ exponential(1);\n  sigma_v ~ exponential(1);\n  \n  // likelihood \n  for(k in 1:K) {\n    // detection random effect\n    real p_k = inv_logit(mu_p + sigma_p * p_z[k]);\n    \n    // link random effect\n    real alpha_k = mu_alpha + sigma_alpha * alpha_z[k];\n    \n    // body mass slopes \n    real b_k = mu_b + sigma_b * b_z[k];\n    \n    for(i in 1:N_cons) {\n      // consumer random effects \n      real u_ik = sigma_u * u_z[i,k];\n      \n      for(j in 1:N_res) {\n        // resource random effect \n        real v_jk = sigma_v * v_z[j,k];\n        \n        // link probability \n        real pi_ijk = inv_logit(alpha_k + (u_ik + b_k*M[i,k]) + v_jk);\n        \n        // detection adjusted probability \n        real q_ijk = p_k * pi_ijk;\n        \n        // likelihood\n        A[i,j,k] ~ bernoulli(q_ijk);\n      }\n    }\n  }\n}\nAs before, we fit the model but with slightly increased adapt_delta to accommodate.\n\nBmod &lt;- cmdstan_model(\"detection_model_bodymass.stan\")\n\nfit2 &lt;- modB$sample(\n  data = data_list,\n  seed = 123,\n  chains = 4,\n  parallel_chains = 4,\n  adapt_delta = 0.95\n)\n\nfit2$save_output_files()\n\nAs before, we want to compare the predicted values of \\(\\hat{\\alpha}_k\\), \\(\\hat{p}_k\\), and \\(\\hat{b}_k\\) to their input values.\n\nfocal_pars2 = data.frame(k = factor(1:k), \n                        alpha_k, p_k, b_k)\nfocal_pars2\n\n  k   alpha_k       p_k       b_k\n1 1 -1.510214 0.2315809 1.0608113\n2 2 -2.398541 0.4549582 1.3326813\n3 3 -1.489164 0.3341748 0.9381326\n\n\n\n\n\n\n\n\n\n\n\nAgain we see a decent concordance between the predicted and input values, although in some cases we are near the edge of the highest density posterior interval.\nNext, we examine the predicted \\(\\hat{b}_k\\) from the posterior against the input values.\n\n\n\n\n\nComparison of the predicted \\(\\hat{b}_k\\) values against the input values \\(b_k\\)."
  },
  {
    "objectID": "posts/2025-11-17-food-web-measurement/index.html#footnotes",
    "href": "posts/2025-11-17-food-web-measurement/index.html#footnotes",
    "title": "Food Web Generation and Measurement I",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nDetails of how to use tidybayes can be found here.↩︎\nAllesina (2011) explore additional possibilities, such as the Ratio model, that we discuss in more detail in the next post.↩︎"
  },
  {
    "objectID": "posts/2025-11-21-primary-or-secondary/index.html",
    "href": "posts/2025-11-21-primary-or-secondary/index.html",
    "title": "Primary or Secondary?",
    "section": "",
    "text": "Let’s suppose we are interested in the relationship between disturbance (D) and vegetation diversity (V). We assert that disturbance has a causal effect on diversity such that \\(D \\rightarrow V\\).\nBoth disturbance and vegetation diversity arise from spatial processes, and the data we use to study them are collected in space. This makes it natural to assume that there may be some spatial autocorrelation in these measures. We might think it is simply a question of how to control for this autocorrelation so that we can get a precise estimate of the effect of D on V. For example, we might use a conditional autoregressive model, treating D and V as emissions from a random field.\nHowever, I argue that rather than assuming we must control for autocorrelation, we need o first determine whether we need to adjust for autocorrelation by looking at the problem from a causal inference perspective.\n\nA Joint Spatial Process\nFor example, let’s suppose that D and V arise jointly from a spatial process S.\n\nlibrary(dagitty)\nlibrary(ggdag)\nlibrary(ggplot2)\n\ndag2 = dagify(\n  V ~ D, \n  D ~ S, \n  V ~ S,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag2, layout = 'circle') + theme_void()\n\n\n\n\n\n\n\n\nThis DAG says that both of our measures, D and V, are caused by the same spatial process. Put differently, the effect of D on V is confounded by spatial autocorrelation in these variables. This implies that we must include S in a model.\n\nggdag_adjustment_set(dag2) + theme_void()\n\n\n\n\n\n\n\n\nSimple enough. But is this actually plausible? If true, then disturbance and vegetation diversity must both occur at a similar scale. This is a strong assumption considering that measures of vegetation diversity occur at the organism or stand level, whereas disturbance is typically a patch level phenomenon. If there is spatial structure to these measures, they would occur at distinct scales.\nMoreover, the processes that underlie this spatial structure are probably distinct. Disturbances, for example, can be due to tree-falls, hurricanes, landslides, anthropogenic land changes, diseases or pest outbreaks, and so on. These are quite different from the processes that shape vegetation diversity like local competition, facilitation, and mutualism; dispersal and recruitment; or nutrient availability.\n\n\nIndependent Spatial Processes\nIt seems more likely that D and V have their own spatial patterns arises from distinct processes. This implies a DAG like this:\n\ndag3 = dagify(\n  V ~ D, \n  D ~ S_D, \n  V ~ S_V,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag3, layout = 'tree') + theme_void()\n\n\n\n\n\n\n\n\nIf this is our generating process, then we need to be much more careful about including S_D and S_V in a model.\n\nggdag_adjustment_set(dag3) + theme_void()\n\n\n\n\n\n\n\n\nThe current structure contains no backdoor paths. If we include S_D, for example, then we will filter our any effect of D that is correlated with S_D. One could then ask: “Why not condition directly on S_D and leave our D, altogether?” This could work but only if we know that the variation in S_D is due solely to the disturbance. S_V does not have these same issues We could include S_V as a covariate that might improve the precision of our estimate of D on V.\n\n\nPrimary and Secondary Structure\nNow here is where this gets interesting. S_D and S_V are what some might call “secondary spatial structure”. They are patterns of vegetation and disturbance that are overlaid on the landscape with all its topography and geomorphology – the primary spatial structure. One could very reasonably assume that this primary structure influences the secondary structure. Indeed, many have debated this tension in the literature. A DAG representing this might look like the following:\n\ndag4 = dagify(\n  V ~ D, \n  D ~ S_D, \n  V ~ S_V,\n  S_D ~ P, \n  S_V ~ P,\n  exposure = 'D', \n  outcome  = 'V'\n)\nggdag(dag4, layout = 'tree') + theme_void()\n\n\n\n\n\n\n\n\nNow we again have a backdoor between D and V through the influence of P on S_D and S_V. This means that in order to estimate the relationship between D and V, we must adust for P, assuming that we have a measure of it.\n\nggdag_adjustment_set(dag4) + theme_void()\n\n\n\n\n\n\n\n\nFurther, one can break the backdoor path by adjusting for any of the parents of D and V. However, we must be careful here about what we actually mean by P. For all we know, P could represent physical laws. If that is the case, then pretty much any DAG we ever draw would be confounded! What began as a relatively simple modeling problem has taken us to a deeply philosophical place where we question whether we can ever really know the causal effect of anything…\nOkay, that was a little unserious. Of course we can know causal effects. And P in the graph cannot be the fundamental laws of physics. Even if they were, they would be constants and so they would do little to shape any variation in these variables.\nThe more prudent question is whether there is an ultimate common cause of spatial structure."
  },
  {
    "objectID": "posts/posts.html",
    "href": "posts/posts.html",
    "title": "Blog",
    "section": "",
    "text": "Food Web Generation and Measurement I\n\n\nLinks and Detection\n\n\n\ncommunity ecology\n\nfood webs\n\nhierarchical modeling\n\n\n\n\n\n\n\n\n\nNov 17, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nFood Web Generation and Measurement II\n\n\nNon-Random Detection\n\n\n\ncommunity ecology\n\nfood webs\n\nhierarchical modeling\n\n\n\n\n\n\n\n\n\nNov 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nPrimary or Secondary?\n\n\nA Question of Ultimate Common Cause\n\n\n\ncausal inference\n\nspatial autocorrelation\n\n\n\n\n\n\n\n\n\nNov 21, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nSpatial Patterns and Random Fields I\n\n\n\n\n\n\nlandscape ecology\n\nspatial patterns\n\n\n\n\n\n\n\n\n\nDec 2, 2025\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-12-02-spatial-patterns-1/index.html#correlation-function",
    "href": "posts/2025-12-02-spatial-patterns-1/index.html#correlation-function",
    "title": "Spatial Patterns and Random Fields I",
    "section": "Correlation Function",
    "text": "Correlation Function\nWe can express the surface \\(X(i,j)\\) as a correlation surface \\(\\hat{C}(h,k)\\) where \\((h,k)\\) is some spatial lag. The function to compute this is\n\\[\n\\begin{align}\n\\hat{C}(h,k) = \\frac{1}{N_{h,k}} \\sum^{N-h}_{i=1} \\sum^{N-k}_{j=1} \\frac{(X(i,j) - \\bar{X})(X(i+h,j+k)-\\bar{X}}{\\hat{\\sigma}^2}\n\\end{align}\n\\]\nThis equation centers the values of \\(X(i,j)\\) using the mean \\(\\bar{X}\\), then centers the difference between \\(X(i,j)\\) and \\(X(h,k)\\). This expression is then rescaled by the variance \\(\\hat{\\sigma}^2\\). The fraction \\(\\frac{1}{N_{h,k}}\\) identifies the valid pairs to compare after the differences are summed over.\n\ncorr_surface = function(X) {\n  N = nrow(X)\n  meanX = mean(X)\n  varX  = var(as.vector(X))\n  \n  C = matrix(0, N, N)\n  \n  for(h in 0:(N-1)) for(k in 0:(N-1)) {\n    \n    total = 0\n    count = 0\n    \n    for(i in 1:(N-h)) for(j in 1:(N-k)) {\n      \n      a = X[i,j] - meanX\n      b = X[i+h,j+k] - meanX\n      \n      total = total + (a * b)\n      count = count + 1\n      \n    }\n    C[h+1,k+1] = total / (count * varX)\n  }\n  return(C)\n}\n\nX = simulate_grf(N = 50, ell = 2, sigma = 1)\nC = corr_surface(X)\n\ncorr_df = expand.grid(i = 1:nrow(C), j = 1:ncol(C)) |&gt; \n  mutate(C = as.vector(C), \n         X = as.vector(X))\n\nggplot(corr_df, aes(x=j, y=i, fill=X)) + \n  geom_tile() + \n  scale_fill_gradientn(colours = pal1(N)) + \n  coord_fixed() + \n  labs(fill = 'X') + \n  \n  theme(panel.background = element_rect(color='black', fill=NA, size=2)) +\n\nggplot(corr_df, aes(x=j, y=i, fill=C)) + \n  geom_tile() + \n  scale_fill_gradientn(colours = pal2(N)) + \n  coord_fixed() + \n  labs(fill = 'C') + \n  \n  theme(panel.background = element_rect(color='black', fill=NA, size=2))\n\n\n\n\n\n\n\n\nWith the correlation surface in hand, we can reduce it to a correlation function by first defining the distance between each pair\n\\[\n\\begin{align}\nd(h,k) = \\sqrt{h^2 + k^2}.\n\\end{align}\n\\]\nIn code, this looks like\n\nhk = expand.grid(\n  h = 0:(N-1), \n  k = 0:(N-1)\n)\n\nhk$d = sqrt(hk$h^2 + hk$k^2)\n\nWe then define bins for the distance and compute the average correlation within each bin\n\\[\n\\begin{align}\n\\hat{C}(d) = \\text{mean} \\biggl\\{\\hat{C}(h,k):(h,k) \\in B_d \\biggr\\}.\n\\end{align}\n\\]\nHere we define the distance bins using delta to define the intervals of interest. If delta = 1, this is the same as rounding down the distances using floor. Plug in the surface from corr_surface and average the correlations within each bin, along with the number of pairs.\n\ncorr_distance = function(C, delta=1, min_pairs = NULL) {\n  N = nrow(C)\n  \n  # define the grid\n  hk = expand.grid(\n    h = 0:(N-1), \n    k = 0:(N-1)\n  )\n  \n  # sqrt of distance \n  hk$d = sqrt(hk$h^2 + hk$k^2)\n  hk$C = as.vector(C)\n  \n  # distance bins \n  maxd = max(hk$d)\n  centers = seq(0, maxd, by=delta)\n  \n  cd = data.frame(\n    distance = centers, \n    corr     = NA, \n    n_pairs  = NA\n    )\n  \n  for(idx in seq_along(centers)) {\n    d0 = centers[idx]\n    # find distances within the bin\n    in_bin = abs(hk$d - d0) &lt; (delta / 2)\n    vals = hk$C[in_bin]\n    \n    if(length(vals) &gt; 0) {\n      cd$corr[idx]    = mean(vals)\n      cd$n_pairs[idx] = length(vals)\n    } else {\n      cd$corr[idx]    = NA\n      cd$n_pairs      = 0\n    }\n  }\n  \n  if(!is.null(min_pairs)) {\n    cd = cd |&gt; filter(n_pairs &gt;= min_pairs)\n  } \n  return(cd)\n}\n\ncd = corr_distance(C, delta = 1)\n\nggplot(cd, aes(x=distance, y=corr)) + \n  geom_line(size=1, color='red') + \n  labs(x = 'd', y = TeX(\"$\\\\hat{C}(d)$\"))\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\nThe graph shows that cells which are close together in space are highly correlated, that this correlation decays rapidly, but it oscillates. This can indicate some quasi-periodicity in the spatial patterns.\nWe can now apply this function to different spatial patterns generated by varying the value of \\(\\ell\\), and compare the correlation distances.\n\nell_seq = 1:4\nC_list = list()\nfor(k in 1:length(ell_seq)) {\n  x = simulate_grf(N, sigma = 1, ell = ell_seq[k])\n  c = corr_surface(x)\n  d = corr_distance(c, delta = 1)\n  d$ell = k\n  C_list[[k]] = d\n}\n\ncp = bind_rows(C_list) |&gt; \n  ggplot(aes(x=distance, y=corr, color = factor(ell))) + \n  geom_line(size=1) + \n  labs(color = '\\u2113', x = 'd', y = TeX(\"$\\\\hat{C}(d)$\")) \n\np1 / cp + plot_layout(heights = c(2.75,1.5))"
  }
]